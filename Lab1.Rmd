---
title: "BINF 6310 Lab 1 R Notebook"
output: html_notebook
---

Loaded Die:
P(1)=0.1
P(2)=0.1
P(3)=0.1
P(4)=0.1
P(5)=0.1
P(6)=0.5

Question 1: What is the mean and variance for the loaded dice?
```{r}
probs <- c(0.1,0.1,0.1,0.1,0.1,0.5)
seq1 = seq(6)
mean = 0
variance = 0

for (i in 1:length(probs)) {
    mean <- mean + (seq1[i]*probs[i])
}
mean #[1] 4.5

for (j in 1:length(probs)) {
    variance <- variance + (probs[j] * (seq1[j] - mean) ^ 2)
}
variance #[1] 3.25
```

Question 2: Make a function in R that “rolls” this dice; return a vector containing the rolls.

		So if I call:  myRolls <- rollLoadedDie(10000)
   
     I would get a vector of size 10,000 that contains the rolls of my loaded die.
```{r}
probs <- c(0.1,0.1,0.1,0.1,0.1,0.5)
rollLoadedDie <- function(x) {
  rolls <- vector(length=x,mode="double")
  for (j in 1:x) {
    rolls[j] <- sample(1:6, 1, prob=probs)
  }
  return (rolls)
}

myRolls <- rollLoadedDie(10000)
head(myRolls)
```

Question 3: Make a histogram of some large number of rolls.  Do the rolls of the loaded die approximate a uniform distribution?
```{r}
hist(rollLoadedDie(100000))
```
These rolls of the loaded die do not approximate a uniform distribution.

Question 4: Modify the code on Slide #58 of lecture #2 so that the means vs. trial size plots are from the loaded die.  Generate these plots a few times.  How many rolls appear to be necessary to get convergence on the expected values for the mean and variance?
```{r}
rm=(list=ls())
probs <- c(0.1,0.1,0.1,0.1,0.1,0.5)
seq1 = seq(6)
trialSizes <- c(5,10,15,20,25,30,40,50,100,200,300,400,500,1000,2000,3000,4000,5000,10000,20000,30000,100000)
means <- vector(mode="double",length=length(trialSizes))
variances <- vector(mode="double",length=length(trialSizes))

for (i in 1:length(trialSizes)) {
  rolls <- vector(length=trialSizes[i],mode="double")
  
  for (j in 1:trialSizes[i]) {
    rolls[j] <- sample(1:6, 1, prob=probs)
  }
  means[i] <- mean(rolls)
  variances[i] <- var(rolls)
}

plot(log10(trialSizes),means)
lines(log10(trialSizes),rep(4.5,length(trialSizes)))
windows()
plot(log10(trialSizes),variances)
lines(log10(trialSizes),rep(3.25,length(trialSizes)))
```
The mean and variance values both seem to converge towards the expected values above the 3.1-3.2 range of the logarithmic values, which is above 1200 rolls.